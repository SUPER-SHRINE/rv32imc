# RV32M 拡張命令

RV32M は、乗算 (Multiply) および除算 (Divide) に関する命令セットです。

## MUL (Multiply)

MUL (multiply) は R 形式の命令で、2 つのレジスタの値（32ビット符号付き整数）を乗算し、結果の下位 32 ビットをレジスタに格納します。

### 命令フォーマット
```
| 31      25 | 24    20 | 19    15 | 14  12 | 11  7 | 6    0 |
|:----------:|:--------:|:--------:|:------:|:-----:|:------:|
| 0000001    | rs2      | rs1      | funct3 | rd    | opcode |
```
- **rs2**: ソースレジスタ 2
- **rs1**: ソースレジスタ 1
- **rd**: 書き込み先レジスタ
- **opcode**: `0110011`
- **funct3**: `000`
- **funct7**: `0000001`

### 動作

```
x[rd] = x[rs1] * x[rs2]
```

### 説明

MUL 命令は、レジスタ `rs1` と `rs2` の値を 32 ビット符号付き整数として乗算し、その結果の下位 32 ビットを `rd` に格納します。符号付きと符号なしの乗算で下位 32 ビットの結果は同じになるため、この命令は符号なし整数の乗算としても使用できます。

## MULH (Multiply High)

MULH (multiply high) は R 形式の命令で、2 つのレジスタの値（32ビット符号付き整数）を乗算し、結果の上位 32 ビットをレジスタに格納します。

### 命令フォーマット
```
| 31      25 | 24    20 | 19    15 | 14  12 | 11  7 | 6    0 |
|:----------:|:--------:|:--------:|:------:|:-----:|:------:|
| 0000001    | rs2      | rs1      | funct3 | rd    | opcode |
```
- **rs2**: ソースレジスタ 2
- **rs1**: ソースレジスタ 1
- **rd**: 書き込み先レジスタ
- **opcode**: `0110011`
- **funct3**: `001`
- **funct7**: `0000001`

### 動作

```
x[rd] = (x[rs1] *s x[rs2]) >> 32
```

### 説明

MULH 命令は、レジスタ `rs1` と `rs2` の値を 32 ビット符号付き整数として乗算し、その 64 ビットの結果のうち上位 32 ビットを `rd` に格納します。

## MULHSU (Multiply High Signed/Unsigned)

MULHSU (multiply high signed/unsigned) は R 形式の命令で、符号付き整数 (`rs1`) と符号なし整数 (`rs2`) を乗算し、結果の上位 32 ビットをレジスタに格納します。

### 命令フォーマット
```
| 31      25 | 24    20 | 19    15 | 14  12 | 11  7 | 6    0 |
|:----------:|:--------:|:--------:|:------:|:-----:|:------:|
| 0000001    | rs2      | rs1      | funct3 | rd    | opcode |
```
- **rs2**: ソースレジスタ 2 (符号なし)
- **rs1**: ソースレジスタ 1 (符号付き)
- **rd**: 書き込み先レジスタ
- **opcode**: `0110011`
- **funct3**: `010`
- **funct7**: `0000001`

### 動作

```
x[rd] = (x[rs1] *s x[rs2]) >> 32
```
※ `rs1` は符号付き、`rs2` は符号なしとして扱われます。

### 説明

MULHSU 命令は、レジスタ `rs1` を符号付き整数、`rs2` を符号なし整数として扱い、それらを乗算した 64 ビットの結果のうち上位 32 ビットを `rd` に格納します。

